<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Hamster Empire</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
            color: white;
        }
        
        .container {
            max-width: 400px;
            margin: 0 auto;
            padding: 10px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        
        .coin-counter {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            font-weight: bold;
            margin: 10px 0;
            color: #ffd700;
        }
        
        .tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 25px;
            margin: 20px 0;
            padding: 5px;
            overflow-x: auto;
        }
        
        .tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 12px;
            white-space: nowrap;
        }
        
        .tab.active {
            background: rgba(255, 255, 255, 0.2);
            color: #ffd700;
        }
        
        .tab-content {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 10px 0;
            backdrop-filter: blur(10px);
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* HAMSTER FARM STYLES */
        .hamsters-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .hamster {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .hamster:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        .hamster.mining {
            border-color: #ffd700;
            animation: mining 2s infinite;
        }
        
        @keyframes mining {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .hamster-emoji {
            font-size: 40px;
            margin-bottom: 10px;
            display: block;
        }
        
        .collect-btn {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #333;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            margin-top: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .collect-btn:hover {
            transform: scale(1.05);
        }
        
        /* SPINNING WHEEL STYLES */
        .wheel-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        
        .wheel {
            width: 280px;
            height: 280px;
            border-radius: 50%;
            position: relative;
            background: conic-gradient(
                #ff6b6b 0deg 45deg,
                #4ecdc4 45deg 90deg,
                #45b7d1 90deg 135deg,
                #96ceb4 135deg 180deg,
                #feca57 180deg 225deg,
                #ff9ff3 225deg 270deg,
                #54a0ff 270deg 315deg,
                #5f27cd 315deg 360deg
            );
            transition: transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99);
            border: 8px solid #fff;
            box-shadow: 0 0 30px rgba(0,0,0,0.3);
        }
        
        .wheel::before {
            content: '';
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 25px solid #fff;
            z-index: 10;
        }
        
        .wheel-segment {
            position: absolute;
            width: 50%;
            height: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .spin-btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }
        
        .spin-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        
        .spin-btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }
        
        .spins-left {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 20px;
            margin: 10px;
        }
        
        /* RUNNER GAME STYLES */
        .runner-game {
            position: relative;
            width: 100%;
            height: 300px;
            background: linear-gradient(180deg, #87CEEB 0%, #98FB98 100%);
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .runner-hamster {
            position: absolute;
            bottom: 50px;
            left: 50px;
            font-size: 40px;
            z-index: 10;
            transition: bottom 0.3s ease;
        }
        
        .runner-hamster.jumping {
            bottom: 120px;
        }
        
        .obstacle {
            position: absolute;
            bottom: 50px;
            right: -50px;
            font-size: 30px;
            animation: moveLeft 3s linear infinite;
        }
        
        @keyframes moveLeft {
            from { right: -50px; }
            to { right: 100%; }
        }
        
        .coin-runner {
            position: absolute;
            top: 80px;
            right: -30px;
            font-size: 25px;
            animation: moveLeft 2.5s linear infinite;
        }
        
        .runner-controls {
            text-align: center;
            margin: 20px 0;
        }
        
        .jump-btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }
        
        .runner-score {
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            display: none;
        }
        
        .restart-btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 15px;
        }
        
        /* SHOP STYLES */
        .shop-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            margin: 10px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .shop-item-info {
            display: flex;
            align-items: center;
        }
        
        .shop-item-emoji {
            font-size: 30px;
            margin-right: 15px;
        }
        
        .buy-btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s ease;
        }
        
        .buy-btn:disabled {
            background: #666;
            cursor: not-allowed;
        }
        
        /* PRIZES STYLES */
        .prize-pool {
            text-align: center;
            background: rgba(255, 215, 0, 0.2);
            padding: 20px;
            border-radius: 15px;
            margin: 15px 0;
            border: 2px solid #ffd700;
        }
        
        .daily-prize {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            text-align: center;
        }
        
        .claim-btn {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #333;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .timer {
            color: #ffd700;
            font-weight: bold;
            margin: 5px 0;
        }
        
        /* RESPONSIVE */
        @media (max-width: 380px) {
            .wheel {
                width: 240px;
                height: 240px;
            }
            
            .runner-game {
                height: 250px;
            }
            
            .tab {
                font-size: 10px;
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üêπ Crypto Hamster Empire</h1>
            <div class="coin-counter">
                ü™ô <span id="coinCount">1000</span>
            </div>
            <div id="telegramStatus" class="status browser">‚ö†Ô∏è Loading...</div>
        </div>

        <!-- Navigation Tabs -->
        <div class="tabs">
            <div class="tab active" onclick="switchTab('farm')">üè† Farm</div>
            <div class="tab" onclick="switchTab('casino')">üé∞ Casino</div>
            <div class="tab" onclick="switchTab('runner')">üèÉ Runner</div>
            <div class="tab" onclick="switchTab('shop')">üõí Shop</div>
            <div class="tab" onclick="switchTab('prizes')">üèÜ Prizes</div>
        </div>

        <!-- HAMSTER FARM TAB -->
        <div id="farm" class="tab-content active">
            <h2>üêπ Your Hamster Miners</h2>
            <div class="hamsters-grid" id="hamstersGrid">
                <!-- Hamsters will be generated here -->
            </div>
        </div>

        <!-- CASINO TAB -->
        <div id="casino" class="tab-content">
            <h2>üé∞ Lucky Spin Casino</h2>
            <div class="wheel-container">
                <div class="spins-left">
                    Free Spins Left: <span id="spinsLeft">3</span>
                    <button onclick="watchAd()" style="margin-left: 10px; padding: 5px 10px; border: none; border-radius: 15px; background: #4CAF50; color: white; cursor: pointer;">Watch Ad (+1 Spin)</button>
                </div>
                
                <div class="wheel" id="wheel">
                    <div class="wheel-segment" style="transform: rotate(0deg);">100ü™ô</div>
                    <div class="wheel-segment" style="transform: rotate(45deg);">üêπ</div>
                    <div class="wheel-segment" style="transform: rotate(90deg);">500ü™ô</div>
                    <div class="wheel-segment" style="transform: rotate(135deg);">‚ö°</div>
                    <div class="wheel-segment" style="transform: rotate(180deg);">1000ü™ô</div>
                    <div class="wheel-segment" style="transform: rotate(225deg);">üéÅ</div>
                    <div class="wheel-segment" style="transform: rotate(270deg);">2000ü™ô</div>
                    <div class="wheel-segment" style="transform: rotate(315deg);">üíé</div>
                </div>
                
                <button class="spin-btn" onclick="spinWheel()" id="spinBtn">
                    üé∞ SPIN NOW! (Cost: FREE)
                </button>
                
                <div id="wheelResult" style="text-align: center; margin: 10px 0; font-weight: bold; color: #ffd700;"></div>
            </div>
        </div>

        <!-- RUNNER GAME TAB -->
        <div id="runner" class="tab-content">
            <h2>üèÉ Hamster Runner</h2>
            <div class="runner-score">
                Score: <span id="runnerScore">0</span> | High Score: <span id="highScore">0</span>
            </div>
            
            <div class="runner-game" id="runnerGame">
                <div class="runner-hamster" id="runnerHamster">üêπ</div>
                <div class="game-over" id="gameOver">
                    <h3>Game Over!</h3>
                    <p>Score: <span id="finalScore">0</span></p>
                    <p>Coins Earned: <span id="coinsEarned">0</span>ü™ô</p>
                    <button class="restart-btn" onclick="startRunnerGame()">Play Again</button>
                </div>
            </div>
            
            <div class="runner-controls">
                <button class="jump-btn" onmousedown="jump()" ontouchstart="jump()">JUMP!</button>
                <button class="jump-btn" onclick="startRunnerGame()" style="margin-left: 10px;">Start Game</button>
            </div>
        </div>

        <!-- SHOP TAB -->
        <div id="shop" class="tab-content">
            <h2>üõí Hamster Shop</h2>
            <div id="shopItems">
                <!-- Shop items will be generated here -->
            </div>
        </div>

        <!-- PRIZES TAB -->
        <div id="prizes" class="tab-content">
            <h2>üèÜ Daily Prizes & Rewards</h2>
            
            <div class="prize-pool">
                <h3>üí∞ Global Prize Pool</h3>
                <div style="font-size: 24px; margin: 10px 0;">ü™ô <span id="globalPool">50,000</span></div>
                <p>Grows every hour!</p>
            </div>
            
            <div class="daily-prize">
                <h4>üéÅ Daily Login Bonus</h4>
                <p>Day <span id="loginDay">1</span> Reward: <span id="dailyReward">100</span>ü™ô</p>
                <div class="timer">Next bonus in: <span id="bonusTimer">23:45:12</span></div>
                <button class="claim-btn" onclick="claimDaily()" id="claimBtn">Claim Reward!</button>
            </div>
            
            <div class="daily-prize">
                <h4>üèÜ Weekly Tournament</h4>
                <p>1st Place: 10,000ü™ô + Rare Hamster</p>
                <p>Your Rank: #<span id="userRank">247</span></p>
                <button class="claim-btn" onclick="joinTournament()">Join Tournament</button>
            </div>
            
            <div class="daily-prize">
                <h4>üéØ Achievement Rewards</h4>
                <p>‚úÖ First 1,000 coins: +100ü™ô</p>
                <p>‚è≥ Own 5 hamsters: +500ü™ô</p>
                <p>‚è≥ Spin wheel 10 times: +Golden Hamster</p>
                <button class="claim-btn" onclick="checkAchievements()">Check Progress</button>
            </div>
        </div>
    </div>

    <script>
        // Game State
        let gameState = {
            coins: 1000,
            hamsters: [],
            spinsLeft: 3,
            runnerScore: 0,
            highScore: localStorage.getItem('hamster-high-score') || 0,
            runnerActive: false,
            dailyLoginDay: 1,
            lastLogin: null,
            achievements: {
                first1000: false,
                own5hamsters: false,
                spin10times: false,
                spinCount: 0
            }
        };

        // Telegram WebApp Integration
        let tg = null;
        let user = null;

        window.addEventListener('load', function() {
            if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
                tg = Telegram.WebApp;
                tg.ready();
                user = tg.initDataUnsafe?.user;
                
                if (user) {
                    document.getElementById('telegramStatus').innerHTML = `‚úÖ Welcome ${user.first_name}!`;
                    document.getElementById('telegramStatus').className = 'status connected';
                } else if (tg) {
                    document.getElementById('telegramStatus').innerHTML = '‚úÖ Telegram Web App loaded';
                    document.getElementById('telegramStatus').className = 'status loaded';
                }
            } else {
                document.getElementById('telegramStatus').innerHTML = '‚ö†Ô∏è Browser mode';
                document.getElementById('telegramStatus').className = 'status browser';
            }
            
            initGame();
        });

        function initGame() {
            // Initialize hamsters
            gameState.hamsters = [
                { name: 'Crypto', emoji: 'üêπ', rate: 10, earnings: 0, type: 'basic' },
                { name: 'Bitcoin', emoji: 'üêπ', rate: 25, earnings: 0, type: 'rare' },
                { name: 'Ethereum', emoji: 'üêπ', rate: 15, earnings: 0, type: 'basic' },
                { name: 'Doge', emoji: 'üêπ', rate: 30, earnings: 0, type: 'epic' }
            ];
            
            renderHamsters();
            renderShop();
            updateUI();
            startMining();
            updatePrizes();
            
            // Update coins every second
            setInterval(() => {
                updateUI();
                updatePrizes();
            }, 1000);
        }

        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // Haptic feedback
            if (tg && tg.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('light');
            }
        }

        function renderHamsters() {
            const grid = document.getElementById('hamstersGrid');
            grid.innerHTML = gameState.hamsters.map((hamster, index) => `
                <div class="hamster mining">
                    <div class="hamster-emoji">${hamster.emoji}</div>
                    <div class="hamster-name">${hamster.name}</div>
                    <div class="hamster-rate">${hamster.rate} coins/min</div>
                    <div style="color: #4CAF50; margin: 5px 0;">+${hamster.earnings}ü™ô</div>
                    <button class="collect-btn" onclick="collectHamster(${index})">
                        Collect
                    </button>
                </div>
            `).join('');
        }

        function renderShop() {
            const shopItems = [
                { name: 'Speed Hamster', emoji: '‚ö°', price: 1000, rate: 50, type: 'epic' },
                { name: 'Golden Hamster', emoji: 'üí∞', price: 2500, rate: 100, type: 'legendary' },
                { name: 'Robot Hamster', emoji: 'ü§ñ', price: 5000, rate: 200, type: 'legendary' },
                { name: 'Diamond Hamster', emoji: 'üíé', price: 10000, rate: 500, type: 'mythic' }
            ];
            
            const shop = document.getElementById('shopItems');
            shop.innerHTML = shopItems.map((item, index) => `
                <div class="shop-item">
                    <div class="shop-item-info">
                        <div class="shop-item-emoji">${item.emoji}</div>
                        <div>
                            <div style="font-weight: bold;">${item.name}</div>
                            <div style="color: #4CAF50;">${item.rate} coins/min</div>
                        </div>
                    </div>
                    <button class="buy-btn" onclick="buyHamster(${index})" ${gameState.coins < item.price ? 'disabled' : ''}>
                        ${item.price}ü™ô
                    </button>
                </div>
            `).join('');
        }

        function startMining() {
            setInterval(() => {
                gameState.hamsters.forEach(hamster => {
                    hamster.earnings += Math.floor(hamster.rate / 60); // Per second
                });
                renderHamsters();
            }, 1000);
        }

        function collectHamster(index) {
            const hamster = gameState.hamsters[index];
            gameState.coins += hamster.earnings;
            hamster.earnings = 0;
            updateUI();
            renderHamsters();
            
            // Haptic feedback
            if (tg && tg.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('medium');
            }
        }

        function buyHamster(shopIndex) {
            const shopItems = [
                { name: 'Speed Hamster', emoji: '‚ö°', price: 1000, rate: 50, type: 'epic' },
                { name: 'Golden Hamster', emoji: 'üí∞', price: 2500, rate: 100, type: 'legendary' },
                { name: 'Robot Hamster', emoji: 'ü§ñ', price: 5000, rate: 200, type: 'legendary' },
                { name: 'Diamond Hamster', emoji: 'üíé', price: 10000, rate: 500, type: 'mythic' }
            ];
            
            const item = shopItems[shopIndex];
            if (gameState.coins >= item.price) {
                gameState.coins -= item.price;
                gameState.hamsters.push({
                    name: item.name,
                    emoji: item.emoji,
                    rate: item.rate,
                    earnings: 0,
                    type: item.type
                });
                
                updateUI();
                renderHamsters();
                renderShop();
                
                // Haptic feedback
                if (tg && tg.HapticFeedback) {
                    tg.HapticFeedback.impactOccurred('heavy');
                }
            }
        }

        // CASINO SPINNING WHEEL
        function spinWheel() {
            if (gameState.spinsLeft <= 0) return;
            
            const spinBtn = document.getElementById('spinBtn');
            const wheel = document.getElementById('wheel');
            
            spinBtn.disabled = true;
            gameState.spinsLeft--;
            gameState.achievements.spinCount++;
            
            // Random spin
            const spins = Math.floor(Math.random() * 8) + 8; // 8-16 full rotations
            const finalDegree = Math.floor(Math.random() * 360);
            const totalRotation = (spins * 360) + finalDegree;
            
            wheel.style.transform = `rotate(${totalRotation}deg)`;
            
            setTimeout(() => {
                const prizes = [
                    { name: '100ü™ô', value: 100, type: 'coins' },
                    { name: 'üêπ', value: 1, type: 'hamster' },
                    { name: '500ü™ô', value: 500, type: 'coins' },
                    { name: '‚ö°', value: 1, type: 'boost' },
                    { name: '1000ü™ô', value: 1000, type: 'coins' },
                    { name: 'üéÅ', value: 1, type: 'mystery' },
                    { name: '2000ü™ô', value: 2000, type: 'coins' },
                    { name: 'üíé', value: 1, type: 'diamond' }
                ];
                
                const segment = Math.floor((360 - (finalDegree % 360)) / 45);
                const prize = prizes[segment] || prizes[0];
                
                givePrize(prize);
                
                document.getElementById('spinsLeft').textContent = gameState.spinsLeft;
                spinBtn.disabled = false;
                
                if (gameState.spinsLeft > 0) {
                    spinBtn.textContent = 'üé∞ SPIN AGAIN! (FREE)';
                } else {
                    spinBtn.textContent = 'üé∞ Watch Ad for Spin';
                    spinBtn.onclick = watchAd;
                }
                
                // Haptic feedback
                if (tg && tg.HapticFeedback) {
                    tg.HapticFeedback.impactOccurred('heavy');
                }
            }, 4000);
        }

        function givePrize(prize) {
            const result = document.getElementById('wheelResult');
            
            switch(prize.type) {
                case 'coins':
                    gameState.coins += prize.value;
                    result.innerHTML = `üéâ WON ${prize.value} COINS!`;
                    break;
                case 'hamster':
                    gameState.hamsters.push({
                        name: 'Lucky',
                        emoji: 'üçÄ',
                        rate: 35,
                        earnings: 0,
                        type: 'rare'
                    });
                    result.innerHTML = `üéâ WON LUCKY HAMSTER!`;
                    renderHamsters();
                    break;
                case 'diamond':
                    gameState.hamsters.push({
                        name: 'Diamond',
                        emoji: 'üíé',
                        rate: 150,
                        earnings: 0,
                        type: 'legendary'
                    });
                    result.innerHTML = `üéâ WON DIAMOND HAMSTER!`;
                    renderHamsters();
                    break;
                default:
                    gameState.coins += 250;
                    result.innerHTML = `üéâ MYSTERY PRIZE: 250 COINS!`;
            }
            
            updateUI();
            
            setTimeout(() => {
                result.innerHTML = '';
            }, 3000);
        }

        function watchAd() {
            // Simulate watching an ad
            gameState.spinsLeft++;
            document.getElementById('spinsLeft').textContent = gameState.spinsLeft;
            
            const spinBtn = document.getElementById('spinBtn');
            spinBtn.textContent = 'üé∞ SPIN NOW! (FREE)';
            spinBtn.onclick = spinWheel;
            
            // In real app, this would show an actual ad
            alert('üì∫ Thanks for watching the ad! +1 Free Spin');
        }

        // HAMSTER RUNNER GAME
        let runnerInterval;
        let obstacleInterval;
        let coinInterval;

        function startRunnerGame() {
            gameState.runnerActive = true;
            gameState.runnerScore = 0;
            
            document.getElementById('gameOver').style.display = 'none';
            document.getElementById('runnerHamster').classList.remove('jumping');
            
            // Clear existing intervals
            clearInterval(runnerInterval);
            clearInterval(obstacleInterval);
            clearInterval(coinInterval);
            
            // Remove existing obstacles and coins
            document.querySelectorAll('.obstacle, .coin-runner').forEach(el => el.remove());
            
            // Start game loop
            runnerInterval = setInterval(() => {
                if (gameState.runnerActive) {
                    gameState.runnerScore += 10;
                    document.getElementById('runnerScore').textContent = gameState.runnerScore;
                }
            }, 100);
            
            // Spawn obstacles
            obstacleInterval = setInterval(() => {
                if (gameState.runnerActive) {
                    createObstacle();
                }
            }, 2000);
            
            // Spawn coins
            coinInterval = setInterval(() => {
                if (gameState.runnerActive) {
                    createCoin();
                }
            }, 1500);
        }

        function createObstacle() {
            const obstacle = document.createElement('div');
            obstacle.className = 'obstacle';
            obstacle.innerHTML = 'üåµ';
            document.getElementById('runnerGame').appendChild(obstacle);
            
            // Check collision
            const collisionCheck = setInterval(() => {
                const hamsterRect = document.getElementById('runnerHamster').getBoundingClientRect();
                const obstacleRect = obstacle.getBoundingClientRect();
                
                if (hamsterRect.left < obstacleRect.right && 
                    hamsterRect.right > obstacleRect.left && 
                    hamsterRect.top < obstacleRect.bottom && 
                    hamsterRect.bottom > obstacleRect.top) {
                    
                    gameOver();
                    clearInterval(collisionCheck);
                }
                
                // Remove obstacle when it goes off screen
                if (obstacleRect.right < 0) {
                    obstacle.remove();
                    clearInterval(collisionCheck);
                }
            }, 50);
        }

        function createCoin() {
            const coin = document.createElement('div');
            coin.className = 'coin-runner';
            coin.innerHTML = 'ü™ô';
            document.getElementById('runnerGame').appendChild(coin);
            
            // Check collection
            const collectionCheck = setInterval(() => {
                const hamsterRect = document.getElementById('runnerHamster').getBoundingClientRect();
                const coinRect = coin.getBoundingClientRect();
                
                if (hamsterRect.left < coinRect.right && 
                    hamsterRect.right > coinRect.left && 
                    hamsterRect.top < coinRect.bottom && 
                    hamsterRect.bottom > coinRect.top) {
                    
                    gameState.coins += 10;
                    updateUI();
                    coin.remove();
                    clearInterval(collectionCheck);
                    
                    // Haptic feedback
                    if (tg && tg.HapticFeedback) {
                        tg.HapticFeedback.impactOccurred('light');
                    }
                }
                
                // Remove coin when it goes off screen
                if (coinRect.right < 0) {
                    coin.remove();
                    clearInterval(collectionCheck);
                }
            }, 50);
        }

        function jump() {
            const hamster = document.getElementById('runnerHamster');
            if (!hamster.classList.contains('jumping')) {
                hamster.classList.add('jumping');
                setTimeout(() => {
                    hamster.classList.remove('jumping');
                }, 600);
                
                // Haptic feedback
                if (tg && tg.HapticFeedback) {
                    tg.HapticFeedback.impactOccurred('medium');
                }
            }
        }

        function gameOver() {
            gameState.runnerActive = false;
            
            clearInterval(runnerInterval);
            clearInterval(obstacleInterval);
            clearInterval(coinInterval);
            
            // Calculate rewards
            const coinsEarned = Math.floor(gameState.runnerScore / 10);
            gameState.coins += coinsEarned;
            
            // Update high score
            if (gameState.runnerScore > gameState.highScore) {
                gameState.highScore = gameState.runnerScore;
                localStorage.setItem('hamster-high-score', gameState.highScore);
                document.getElementById('highScore').textContent = gameState.highScore;
            }
            
            // Show game over screen
            document.getElementById('finalScore').textContent = gameState.runnerScore;
            document.getElementById('coinsEarned').textContent = coinsEarned;
            document.getElementById('gameOver').style.display = 'block';
            
            updateUI();
        }

        // PRIZES & ACHIEVEMENTS
        function updatePrizes() {
            // Update global pool (simulate growing)
            const currentPool = parseInt(document.getElementById('globalPool').textContent);
            document.getElementById('globalPool').textContent = currentPool + Math.floor(Math.random() * 10);
            
            // Update bonus timer
            updateBonusTimer();
            
            // Update user rank (simulate)
            const rank = Math.floor(Math.random() * 1000) + 1;
            document.getElementById('userRank').textContent = rank;
        }

        function updateBonusTimer() {
            const now = new Date();
            const tomorrow = new Date(now);
            tomorrow.setDate(tomorrow.getDate() + 1);
            tomorrow.setHours(0, 0, 0, 0);
            
            const diff = tomorrow - now;
            const hours = Math.floor(diff / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);
            
            document.getElementById('bonusTimer').textContent = 
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function claimDaily() {
            const lastLogin = localStorage.getItem('hamster-last-login');
            const today = new Date().toDateString();
            
            if (lastLogin !== today) {
                const reward = gameState.dailyLoginDay * 100;
                gameState.coins += reward;
                gameState.dailyLoginDay++;
                
                localStorage.setItem('hamster-last-login', today);
                localStorage.setItem('hamster-login-day', gameState.dailyLoginDay);
                
                document.getElementById('loginDay').textContent = gameState.dailyLoginDay;
                document.getElementById('dailyReward').textContent = gameState.dailyLoginDay * 100;
                
                updateUI();
                alert(`üéâ Daily bonus claimed! +${reward} coins!`);
            } else {
                alert('‚ùå Already claimed today! Come back tomorrow.');
            }
        }

        function joinTournament() {
            alert('üèÜ Tournament registration opening soon! Get ready to compete with players worldwide!');
        }

        function checkAchievements() {
            let newAchievements = [];
            
            // Check first 1000 coins
            if (gameState.coins >= 1000 && !gameState.achievements.first1000) {
                gameState.achievements.first1000 = true;
                gameState.coins += 100;
                newAchievements.push('üéØ First 1,000 coins: +100ü™ô');
            }
            
            // Check own 5 hamsters
            if (gameState.hamsters.length >= 5 && !gameState.achievements.own5hamsters) {
                gameState.achievements.own5hamsters = true;
                gameState.coins += 500;
                newAchievements.push('üéØ Own 5 hamsters: +500ü™ô');
            }
            
            // Check spin wheel 10 times
            if (gameState.achievements.spinCount >= 10 && !gameState.achievements.spin10times) {
                gameState.achievements.spin10times = true;
                gameState.hamsters.push({
                    name: 'Golden',
                    emoji: 'üèÜ',
                    rate: 200,
                    earnings: 0,
                    type: 'legendary'
                });
                renderHamsters();
                newAchievements.push('üéØ Spin wheel 10 times: +Golden HamsterüèÜ');
            }
            
            if (newAchievements.length > 0) {
                alert('üéâ Achievements Unlocked:\n' + newAchievements.join('\n'));
                updateUI();
            } else {
                alert('üéØ Keep playing to unlock more achievements!\n\n' +
                      `Progress:\n` +
                      `‚Ä¢ Coins: ${gameState.coins}/1000 ‚úÖ\n` +
                      `‚Ä¢ Hamsters: ${gameState.hamsters.length}/5 ${gameState.hamsters.length >= 5 ? '‚úÖ' : ''}\n` +
                      `‚Ä¢ Spins: ${gameState.achievements.spinCount}/10 ${gameState.achievements.spinCount >= 10 ? '‚úÖ' : ''}`);
            }
        }

        function updateUI() {
            document.getElementById('coinCount').textContent = gameState.coins.toLocaleString();
            document.getElementById('runnerScore').textContent = gameState.runnerScore;
            document.getElementById('highScore').textContent = gameState.highScore;
            renderShop();
        }

        // Keyboard controls for runner
        document.addEventListener('keydown', function(event) {
            if (event.code === 'Space' && gameState.runnerActive) {
                event.preventDefault();
                jump();
            }
        });

        // Touch controls
        document.addEventListener('touchstart', function(event) {
            if (gameState.runnerActive && event.target.closest('#runner')) {
                jump();
            }
        });

        // Auto-save game state
        setInterval(() => {
            localStorage.setItem('hamster-game-state', JSON.stringify(gameState));
        }, 30000);

        // Load saved game state
        window.addEventListener('load', () => {
            const saved = localStorage.getItem('hamster-game-state');
            if (saved) {
                const savedState = JSON.parse(saved);
                gameState = { ...gameState, ...savedState };
                gameState.runnerActive = false; // Reset runner state
            }
            
            const savedDay = localStorage.getItem('hamster-login-day');
            if (savedDay) {
                gameState.dailyLoginDay = parseInt(savedDay);
                document.getElementById('loginDay').textContent = gameState.dailyLoginDay;
                document.getElementById('dailyReward').textContent = gameState.dailyLoginDay * 100;
            }
        });

        // Share functionality
        function shareGame() {
            if (tg && tg.shareUrl) {
                tg.shareUrl('https://annam122.github.io/crypto-hamster-empire/', 
                           'üêπ Join my Crypto Hamster Empire! Build your mining empire and earn crypto coins!');
            } else {
                alert('üêπ Share this game with friends: https://annam122.github.io/crypto-hamster-empire/');
            }
        }
    </script>
</body>
</html>
